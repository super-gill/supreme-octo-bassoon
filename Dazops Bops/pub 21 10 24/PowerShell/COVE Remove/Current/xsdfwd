

firewall {                                                                                                                                                                                                                                  
    all-ping enable                                                                                                                                                                                                                         
    broadcast-ping disable                                                                                                                                                                                                                  
    group {                                                                                                                                                                                                                                 
        address-group authorized_guests {                                                                                                                                                                                                   
            description "authorized guests MAC addresses"                                                                                                                                                                                   
        }                                                                                                                                                                                                                                   
        address-group guest_allow_dns_servers {                                                                                                                                                                                             
            description "allow dns servers for guests"                                                                                                                                                                                      
        }                                                                                                                                                                                                                                   
        address-group guest_portal_address {                                                                                                                                                                                                
            address 52.208.193.150                                                                                                                                                                                                          
            description "guest portal address"                                                                                                                                                                                              
        }                                                                                                                                                                                                                                   
        address-group guest_pre_allow {                                                                                                                                                                                                     
            address 52.208.193.150                                                                                                                                                                                                          
            description "allow addresses for guests"                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        address-group guest_restricted {                                                                                                                                                                                                    
            address 192.168.0.0/16                                                                                                                                                                                                          
            address 10.0.0.0/8                                                                                                                                                                                                              
            address 172.16.0.0/12                                                                                                                                                                                                           
            description "restricted addresses for guests"                                                                                                                                                                                   
        }                                                                                                                                                                                                                                   
        address-group unifi_controller_addresses {                                                                                                                                                                                          
            address 54.75.241.127                                                                                                                                                                                                           
            description "UniFi addresses"                                                                                                                                                                                                   
        }                                                                                                                                                                                                                                   
        ipv6-network-group corporate_networkv6 {                                                                                                                                                                                            
            description "IPv6 corporate subnets"                                                                                                                                                                                            
        }                                                                                                                                                                                                                                   
        ipv6-network-group guest_networkv6 {                                                                                                                                                                                                
            description "IPv6 guest subnets"                                                                                                                                                                                                
        }                                                                                                                                                                                                                                   
        network-group captive_portal_subnets {                                                                                                                                                                                              
            description "captive portal subnets"                                                                                                                                                                                            
        }                                                                                                                                                                                                                                   
        network-group corporate_network {                                                                                                                                                                                                   
            description "corporate subnets"                                                                                                                                                                                                 
            network 192.168.100.0/22                                                                                                                                                                                                        
            network 192.168.200.0/24                                                                                                                                                                                                        
            network 192.168.150.0/24                                                                                                                                                                                                        
            network 10.5.0.0/20                                                                                                                                                                                                             
        }                                                                                                                                                                                                                                   
        network-group guest_network {                                                                                                                                                                                                       
            description "guest subnets"                                                                                                                                                                                                     
            network 172.25.24.0/21                                                                                                                                                                                                          
        }                                                                                                                                                                                                                                   
        network-group remote_client_vpn_network {                                                                                                                                                                                           
            description "remote client VPN subnets"                                                                                                                                                                                         
        }                                                                                                                                                                                                                                   
        network-group remote_site_vpn_network {                                                                                                                                                                                             
            description "remote site VPN subnets"                                                                                                                                                                                           
        }                                                                                                                                                                                                                                   
        network-group remote_user_vpn_network {                                                                                                                                                                                             
            description "Remote User VPN subnets"                                                                                                                                                                                           
        }                                                                                                                                                                                                                                   
        port-group guest_portal_ports {                                                                                                                                                                                                     
            description "guest portal ports"                                                                                                                                                                                                
            port 80                                                                                                                                                                                                                         
            port 443                                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        port-group guest_portal_redirector_ports {                                                                                                                                                                                          
            description "guest portal redirector ports"                                                                                                                                                                                     
            port 39080                                                                                                                                                                                                                      
            port 39443                                                                                                                                                                                                                      
        }                                                                                                                                                                                                                                   
        port-group unifi_controller_ports-tcp {                                                                                                                                                                                             
            description "unifi tcp ports"                                                                                                                                                                                                   
            port 8080                                                                                                                                                                                                                       
        }                                                                                                                                                                                                                                   
        port-group unifi_controller_ports-udp {                                                                                                                                                                                             
            description "unifi udp ports"                                                                                                                                                                                                   
            port 3478                                                                                                                                                                                                                       
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-name AUTHORIZED_GUESTSv6 {                                                                                                                                                                                                         
        default-action drop                                                                                                                                                                                                                 
        description "authorization check packets from guest network"                                                                                                                                                                        
    }                                                                                                                                                                                                                                       
    ipv6-name GUESTv6_IN {                                                                                                                                                                                                                  
        default-action accept                                                                                                                                                                                                               
        description "packets from guest network"                                                                                                                                                                                            
        rule 3001 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop packets to intranet"                                                                                                                                                                                          
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    ipv6-network-group corporate_networkv6                                                                                                                                                                                  
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-name GUESTv6_LOCAL {                                                                                                                                                                                                               
        default-action drop                                                                                                                                                                                                                 
        description "packets from guest network to gateway"                                                                                                                                                                                 
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow DNS"                                                                                                                                                                                                         
            destination {                                                                                                                                                                                                                   
                port 53                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
            protocol udp                                                                                                                                                                                                                    
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow ICMP"                                                                                                                                                                                                        
            protocol icmp                                                                                                                                                                                                                   
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-name GUESTv6_OUT {                                                                                                                                                                                                                 
        default-action accept                                                                                                                                                                                                               
        description "packets forward to guest network"                                                                                                                                                                                      
    }                                                                                                                                                                                                                                       
    ipv6-name LANv6_IN {                                                                                                                                                                                                                    
        default-action accept                                                                                                                                                                                                               
        description "packets from intranet"                                                                                                                                                                                                 
    }                                                                                                                                                                                                                                       
    ipv6-name LANv6_LOCAL {                                                                                                                                                                                                                 
        default-action accept                                                                                                                                                                                                               
        description "packets from intranet to gateway"                                                                                                                                                                                      
    }                                                                                                                                                                                                                                       
    ipv6-name LANv6_OUT {                                                                                                                                                                                                                   
        default-action accept                                                                                                                                                                                                               
        description "packets forward to intranet"                                                                                                                                                                                           
    }                                                                                                                                                                                                                                       
    ipv6-na me WANv6_IN {                                                                                                                                                                                                                    
        default-action drop                                                                                                                                                                                                                 
        description "packets from internet to intranet"                                                                                                                                                                                     
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow established/related sessions"                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established enable                                                                                                                                                                                                          
                invalid disable                                                                                                                                                                                                             
                new disable                                                                                                                                                                                                                 
                related enable                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop invalid state"                                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established disable                                                                                                                                                                                                         
                invalid enable                                                                                                                                                                                                              
                new disable                                                                                                                                                                                                                 
                related disable                                                                                                                                                                                                             
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-name WANv6_LOCAL {                                                                                                                                                                                                                 
        default-action drop                                                                                                                                                                                                                 
        description "packets from internet to gateway"                                                                                                                                                                                      
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "Allow neighbor advertisements"                                                                                                                                                                                     
            icmpv6 {                                                                                                                                                                                                                        
                type neighbor-advertisement                                                                                                                                                                                                 
            }                                                                                                                                                                                                                               
            protocol ipv6-icmp                                                                                                                                                                                                              
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "Allow neighbor solicitation"                                                                                                                                                                                       
            icmpv6 {                                                                                                                                                                                                                        
                type neighbor-solicitation                                                                                                                                                                                                  
            }                                                                                                                                                                                                                               
            protocol ipv6-icmp                                                                                                                                                                                                              
        }                                                                                                                                                                                                                                   
        rule 3003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow established/related sessions"                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established enable                                                                                                                                                                                                          
                invalid disable                                                                                                                                                                                                             
                new disable                                                                                                                                                                                                                 
                related enable                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3004 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop invalid state"                                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established disable                                                                                                                                                                                                         
                invalid enable                                                                                                                                                                                                              
                new disable                                                                                                                                                                                                                 
                related disable                                                                                                                                                                                                             
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-name WANv6_OUT {                                                                                                                                                                                                                   
        default-action accept                                                                                                                                                                                                               
        description "packets to internet"                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ipv6-receive-redirects disable                                                                                                                                                                                                          
    ipv6-src-route disable                                                                                                                                                                                                                  
    ip-src-route disable                                                                                                                                                                                                                    
    log-martians enable                                                                                                                                                                                                                     
    name AUTHORIZED_GUESTS {                                                                                                                                                                                                                
        default-action drop                                                                                                                                                                                                                 
        description "authorization check packets from guest network"                                                                                                                                                                        
    }                                                                                                                                                                                                                                       
    name GUEST_IN {                                                                                                                                                                                                                         
        default-action accept                                                                                                                                                                                                               
        description "packets from guest network"                                                                                                                                                                                            
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow DNS packets to external name servers"                                                                                                                                                                        
            destination {                                                                                                                                                                                                                   
                port 53                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
            protocol tcp_udp                                                                                                                                                                                                                
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow packets to guest portal ports"                                                                                                                                                                               
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    address-group guest_portal_address                                                                                                                                                                                      
                    port-group guest_portal_ports                                                                                                                                                                                           
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow packets to captive portal"                                                                                                                                                                                   
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    network-group captive_portal_subnets                                                                                                                                                                                    
                }                                                                                                                                                                                                                           
                port 443                                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
            protocol tcp                                                                                                                                                                                                                    
        }                                                                                                                                                                                                                                   
        rule 3004 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow packets to allow subnets"                                                                                                                                                                                    
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    address-group guest_pre_allow                                                                                                                                                                                           
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3005 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop packets to restricted subnets"                                                                                                                                                                                
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    address-group guest_restricted                                                                                                                                                                                          
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3006 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop packets to intranet"                                                                                                                                                                                          
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    network-group corporate_network                                                                                                                                                                                         
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3007 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop packets to remote user"                                                                                                                                                                                       
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    network-group remote_user_vpn_network                                                                                                                                                                                   
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3008 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "allow authorized and drop unauthorized"                                                                                                                                                                            
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    address-group authorized_guests                                                                                                                                                                                         
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 172.25.24.0/21"                                                                                                                                                                         
            source {                                                                                                                                                                                                                        
                address 172.25.24.0/21                                                                                                                                                                                                      
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name GUEST_LOCAL {                                                                                                                                                                                                                      
        default-action drop                                                                                                                                                                                                                 
        description "packets from guest network to gateway"                                                                                                                                                                                 
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow DNS"                                                                                                                                                                                                         
            destination {                                                                                                                                                                                                                   
                port 53                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
            protocol tcp_udp                                                                                                                                                                                                                
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow ICMP"                                                                                                                                                                                                        
            protocol icmp                                                                                                                                                                                                                   
        }                                                                                                                                                                                                                                   
        rule 3003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow to DHCP server"                                                                                                                                                                                              
            destination {                                                                                                                                                                                                                   
                port 67                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
            protocol udp                                                                                                                                                                                                                    
            source {                                                                                                                                                                                                                        
                port 68                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3004 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow redirects to redirector"                                                                                                                                                                                     
            destination {                                                                                                                                                                                                                   
                group {                                                                                                                                                                                                                     
                    port-group guest_portal_redirector_ports                                                                                                                                                                                
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
            protocol tcp                                                                                                                                                                                                                    
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name GUEST_OUT {                                                                                                                                                                                                                        
        default-action accept                                                                                                                                                                                                               
        description "packets forward to guest network"                                                                                                                                                                                      
        rule 6001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 172.25.24.0/21"                                                                                                                                                                         
            destination {                                                                                                                                                                                                                   
                address 172.25.24.0/21                                                                                                                                                                                                      
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name LAN_IN {                                                                                                                                                                                                                           
        default-action accept                                                                                                                                                                                                               
        description "packets from intranet"                                                                                                                                                                                                 
        rule 6001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.100.0/22"                                                                                                                                                                       
            source {                                                                                                                                                                                                                        
                address 192.168.100.0/22                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.200.0/24"                                                                                                                                                                       
            source {                                                                                                                                                                                                                        
                address 192.168.200.0/24                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.150.0/24"                                                                                                                                                                       
            source {                                                                                                                                                                                                                        
                address 192.168.150.0/24                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6004 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 10.5.0.0/20"                                                                                                                                                                            
            source {                                                                                                                                                                                                                        
                address 10.5.0.0/20                                                                                                                                                                                                         
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name LAN_LOCAL {                                                                                                                                                                                                                        
        default-action accept                                                                                                                                                                                                               
        description "packets from intranet to gateway"                                                                                                                                                                                      
    }                                                                                                                                                                                                                                       
    name LAN_OUT {                                                                                                                                                                                                                          
        default-action accept                                                                                                                                                                                                               
        description "packets forward to intranet"                                                                                                                                                                                           
        rule 6001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.100.0/22"                                                                                                                                                                       
            destination {                                                                                                                                                                                                                   
                address 192.168.100.0/22                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6002 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.200.0/24"                                                                                                                                                                       
            destination {                                                                                                                                                                                                                   
                address 192.168.200.0/24                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 192.168.150.0/24"                                                                                                                                                                       
            destination {                                                                                                                                                                                                                   
                address 192.168.150.0/24                                                                                                                                                                                                    
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 6004 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "accounting defined network 10.5.0.0/20"                                                                                                                                                                            
            destination {                                                                                                                                                                                                                   
                address 10.5.0.0/20                                                                                                                                                                                                         
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name WAN_IN {                                                                                                                                                                                                                           
        default-action drop                                                                                                                                                                                                                 
        description "packets from internet to intranet"                                                                                                                                                                                     
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow established/related sessions"                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established enable                                                                                                                                                                                                          
                invalid disable                                                                                                                                                                                                             
                new disable                                                                                                                                                                                                                 
                related enable                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop invalid state"                                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established disable                                                                                                                                                                                                         
                invalid enable                                                                                                                                                                                                              
                new disable                                                                                                                                                                                                                 
                related disable                                                                                                                                                                                                             
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3003 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "PortForward [USG Web Access]"                                                                                                                                                                                      
            destination {                                                                                                                                                                                                                   
                address 192.168.100.1                                                                                                                                                                                                       
                port 8080,80,443                                                                                                                                                                                                            
            }                                                                                                                                                                                                                               
            protocol tcp                                                                                                                                                                                                                    
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name WAN_LOCAL {                                                                                                                                                                                                                        
        default-action drop                                                                                                                                                                                                                 
        description "packets from internet to gateway"                                                                                                                                                                                      
        rule 3001 {                                                                                                                                                                                                                         
            action accept                                                                                                                                                                                                                   
            description "allow established/related sessions"                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established enable                                                                                                                                                                                                          
                invalid disable                                                                                                                                                                                                             
                new disable                                                                                                                                                                                                                 
                related enable                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        rule 3002 {                                                                                                                                                                                                                         
            action drop                                                                                                                                                                                                                     
            description "drop invalid state"                                                                                                                                                                                                
            state {                                                                                                                                                                                                                         
                established disable                                                                                                                                                                                                         
                invalid enable                                                                                                                                                                                                              
                new disable                                                                                                                                                                                                                 
                related disable                                                                                                                                                                                                             
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name WAN_OUT {                                                                                                                                                                                                                          
        default-action accept                                                                                                                                                                                                               
        description "packets to internet"                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    options {                                                                                                                                                                                                                               
        mss-clamp {                                                                                                                                                                                                                         
            interface-type pppoe                                                                                                                                                                                                            
            interface-type pptp                                                                                                                                                                                                             
            interface-type vti                                                                                                                                                                                                              
            mss 1452                                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        mss-clamp6 {                                                                                                                                                                                                                        
            interface-type pppoe                                                                                                                                                                                                            
            interface-type pptp                                                                                                                                                                                                             
            mss 1432                                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    receive-redirects disable                                                                                                                                                                                                               
    send-redirects enable                                                                                                                                                                                                                   
    source-validation strict                                                                                                                                                                                                                
    syn-cookies enable                                                                                                                                                                                                                      
}                                                                                                                                                                                                                                           
interfaces {                                                                                                                                                                                                                                
    ethernet eth0 {                                                                                                                                                                                                                         
        address 192.168.100.1/22                                                                                                                                                                                                            
        description LAN                                                                                                                                                                                                                     
        duplex auto                                                                                                                                                                                                                         
        firewall {                                                                                                                                                                                                                          
            in {                                                                                                                                                                                                                            
                ipv6-name LANv6_IN                                                                                                                                                                                                          
                name LAN_IN                                                                                                                                                                                                                 
            }                                                                                                                                                                                                                               
            local {                                                                                                                                                                                                                         
                ipv6-name LANv6_LOCAL                                                                                                                                                                                                       
                name LAN_LOCAL                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
            out {                                                                                                                                                                                                                           
                ipv6-name LANv6_OUT                                                                                                                                                                                                         
                name LAN_OUT                                                                                                                                                                                                                
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        speed auto                                                                                                                                                                                                                          
        vif 2 {                                                                                                                                                                                                                             
            address 172.25.25.1/21                                                                                                                                                                                                          
            firewall {                                                                                                                                                                                                                      
                in {                                                                                                                                                                                                                        
                    ipv6-name GUESTv6_IN                                                                                                                                                                                                    
                    name GUEST_IN                                                                                                                                                                                                           
                }                                                                                                                                                                                                                           
                local {                                                                                                                                                                                                                     
                    ipv6-name GUESTv6_LOCAL                                                                                                                                                                                                 
                    name GUEST_LOCAL                                                                                                                                                                                                        
                }                                                                                                                                                                                                                           
                out {                                                                                                                                                                                                                       
                    ipv6-name GUESTv6_OUT                                                                                                                                                                                                   
                    name GUEST_OUT                                                                                                                                                                                                          
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        vif 20 {                                                                                                                                                                                                                            
            address 192.168.200.1/24                                                                                                                                                                                                        
            firewall {                                                                                                                                                                                                                      
                in {                                                                                                                                                                                                                        
                    ipv6-name LANv6_IN                                                                                                                                                                                                      
                    name LAN_IN                                                                                                                                                                                                             
                }                                                                                                                                                                                                                           
                local {                                                                                                                                                                                                                     
                    ipv6-name LANv6_LOCAL                                                                                                                                                                                                   
                    name LAN_LOCAL                                                                                                                                                                                                          
                }                                                                                                                                                                                                                           
                out {                                                                                                                                                                                                                       
                    ipv6-name LANv6_OUT                                                                                                                                                                                                     
                    name LAN_OUT                                                                                                                                                                                                            
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        vif 30 {                                                                                                                                                                                                                            
            address 192.168.150.1/24                                                                                                                                                                                                        
            firewall {                                                                                                                                                                                                                      
                in {                                                                                                                                                                                                                        
                    ipv6-name LANv6_IN                                                                                                                                                                                                      
                    name LAN_IN                                                                                                                                                                                                             
                }                                                                                                                                                                                                                           
                local {                                                                                                                                                                                                                     
                    ipv6-name LANv6_LOCAL                                                                                                                                                                                                   
                    name LAN_LOCAL                                                                                                                                                                                                          
                }                                                                                                                                                                                                                           
                out {                                                                                                                                                                                                                       
                    ipv6-name LANv6_OUT                                                                                                                                                                                                     
                    name LAN_OUT                                                                                                                                                                                                            
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        vif 60 {                                                                                                                                                                                                                            
            address 10.5.0.1/20                                                                                                                                                                                                             
            firewall {                                                                                                                                                                                                                      
                in {                                                                                                                                                                                                                        
                    ipv6-name LANv6_IN                                                                                                                                                                                                      
                    name LAN_IN                                                                                                                                                                                                             
                }                                                                                                                                                                                                                           
                local {                                                                                                                                                                                                                     
                    ipv6-name LANv6_LOCAL                                                                                                                                                                                                   
                    name LAN_LOCAL                                                                                                                                                                                                          
                }                                                                                                                                                                                                                           
                out {                                                                                                                                                                                                                       
                    ipv6-name LANv6_OUT                                                                                                                                                                                                     
                    name LAN_OUT                                                                                                                                                                                                            
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ethernet eth1 {                                                                                                                                                                                                                         
        disable                                                                                                                                                                                                                             
        duplex auto                                                                                                                                                                                                                         
        speed auto                                                                                                                                                                                                                          
    }                                                                                                                                                                                                                                       
    ethernet eth2 {                                                                                                                                                                                                                         
        address 192.168.50.2/24                                                                                                                                                                                                             
        description WAN                                                                                                                                                                                                                     
        duplex auto                                                                                                                                                                                                                         
        firewall {                                                                                                                                                                                                                          
            in {                                                                                                                                                                                                                            
                ipv6-name WANv6_IN                                                                                                                                                                                                          
                name WAN_IN                                                                                                                                                                                                                 
            }                                                                                                                                                                                                                               
            local {                                                                                                                                                                                                                         
                ipv6-name WANv6_LOCAL                                                                                                                                                                                                       
                name WAN_LOCAL                                                                                                                                                                                                              
            }                                                                                                                                                                                                                               
            out {                                                                                                                                                                                                                           
                ipv6-name WANv6_OUT                                                                                                                                                                                                         
                name WAN_OUT                                                                                                                                                                                                                
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        speed auto                                                                                                                                                                                                                          
    }                                                                                                                                                                                                                                       
    ethernet eth3 {                                                                                                                                                                                                                         
        disable                                                                                                                                                                                                                             
        duplex auto                                                                                                                                                                                                                         
        speed auto                                                                                                                                                                                                                          
    }                                                                                                                                                                                                                                       
    loopback lo {                                                                                                                                                                                                                           
    }                                                                                                                                                                                                                                       
}                                                                                                                                                                                                                                           
port-forward {                                                                                                                                                                                                                              
    auto-firewall disable                                                                                                                                                                                                                   
    hairpin-nat enable                                                                                                                                                                                                                      
    lan-interface eth0.20                                                                                                                                                                                                                   
    lan-interface eth0.30                                                                                                                                                                                                                   
    lan-interface eth0.60                                                                                                                                                                                                                   
    lan-interface eth0                                                                                                                                                                                                                      
    lan-interface eth0.2                                                                                                                                                                                                                    
    rule 3001 {                                                                                                                                                                                                                             
        description "USG Web Access"                                                                                                                                                                                                        
        forward-to {                                                                                                                                                                                                                        
            address 192.168.100.1                                                                                                                                                                                                           
        }                                                                                                                                                                                                                                   
        original-port 8080,80,443                                                                                                                                                                                                           
        protocol tcp                                                                                                                                                                                                                        
    }                                                                                                                                                                                                                                       
    wan-interface eth2                                                                                                                                                                                                                      
}                                                                                                                                                                                                                                           
protocols {                                                                                                                                                                                                                                 
    static {                                                                                                                                                                                                                                
        route 0.0.0.0/0 {                                                                                                                                                                                                                   
            next-hop 192.168.50.1 {                                                                                                                                                                                                         
                distance 1                                                                                                                                                                                                                  
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
}                                                                                                                                                                                                                                           
service {                                                                                                                                                                                                                                   
    dhcp-server {                                                                                                                                                                                                                           
        disabled false                                                                                                                                                                                                                      
        global-parameters "class &quot;denied&quot; { match substring (hardware, 1, 6); deny booting; } subclass &quot;denied&quot; e0:63:da:2b:57:74; subclass &quot;denied&quot; e0:63:da:2b:57:75; subclass &quot;denied&quot; e0:63:da:2
b:57:76; subclass &quot;denied&quot; e0:63:da:2b:57:77;"                                                                                                                                                                                    
        hostfile-update enable                                                                                                                                                                                                              
        shared-network-name net_Guest_eth0_10.5.0.0-20 {                                                                                                                                                                                    
            authoritative enable                                                                                                                                                                                                            
            description vlan60                                                                                                                                                                                                              
            subnet 10.5.0.0/20 {                                                                                                                                                                                                            
                default-router 10.5.0.1                                                                                                                                                                                                     
                dns-server 10.5.0.1                                                                                                                                                                                                         
                domain-name local.domain                                                                                                                                                                                                    
                lease 14400                                                                                                                                                                                                                 
                start 10.5.0.26 {                                                                                                                                                                                                           
                    stop 10.5.15.254                                                                                                                                                                                                        
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        shared-network-name net_LAN_eth0_192.168.100.0-22 {                                                                                                                                                                                 
            authoritative enable                                                                                                                                                                                                            
            description vlan1                                                                                                                                                                                                               
            subnet 192.168.100.0/22 {                                                                                                                                                                                                       
                default-router 192.168.100.1                                                                                                                                                                                                
                dns-server 192.168.100.1                                                                                                                                                                                                    
                domain-name localdomain                                                                                                                                                                                                     
                lease 14400                                                                                                                                                                                                                 
                start 192.168.101.1 {                                                                                                                                                                                                       
                    stop 192.168.103.253                                                                                                                                                                                                    
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        shared-network-name net_TV_network_eth0_192.168.200.0-24 {                                                                                                                                                                          
            authoritative enable                                                                                                                                                                                                            
            description vlan20                                                                                                                                                                                                              
            subnet 192.168.200.0/24 {                                                                                                                                                                                                       
                default-router 192.168.200.1                                                                                                                                                                                                
                dns-server 192.168.200.1                                                                                                                                                                                                    
                domain-name tvnetwork                                                                                                                                                                                                       
                lease 86400                                                                                                                                                                                                                 
                start 192.168.200.10 {                                                                                                                                                                                                      
                    stop 192.168.200.250                                                                                                                                                                                                    
                }                                                                                                                                                                                                                           
                static-mapping 94-c6-91-a9-c8-1b {                                                                                                                                                                                          
                    host-record disable                                                                                                                                                                                                     
                    ip-address 192.168.200.2                                                                                                                                                                                                
                    mac-address 94:c6:91:a9:c8:1b                                                                                                                                                                                           
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        static-arp disable                                                                                                                                                                                                                  
        use-dnsmasq disable                                                                                                                                                                                                                 
    }                                                                                                                                                                                                                                       
    dns {                                                                                                                                                                                                                                   
        forwarding {                                                                                                                                                                                                                        
            cache-size 10000                                                                                                                                                                                                                
            except-interface eth2                                                                                                                                                                                                           
            options all-servers                                                                                                                                                                                                             
            options cname=unifi.localdomain,unifi.tvnetwork,unifi.phones,unifi.local.domain,unifi                                                                                                                                           
            options server=8.8.8.8                                                                                                                                                                                                          
            options server=8.8.4.4                                                                                                                                                                                                          
            options host-record=unifi,54.75.241.127                                                                                                                                                                                         
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    gui {                                                                                                                                                                                                                                   
        http-port 80                                                                                                                                                                                                                        
        https-port 443                                                                                                                                                                                                                      
        older-ciphers enable                                                                                                                                                                                                                
    }                                                                                                                                                                                                                                       
    lldp {                                                                                                                                                                                                                                  
        interface eth2 {                                                                                                                                                                                                                    
            disable                                                                                                                                                                                                                         
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    nat {                                                                                                                                                                                                                                   
        rule 6001 {                                                                                                                                                                                                                         
            description "MASQ corporate_network to WAN"                                                                                                                                                                                     
            log disable                                                                                                                                                                                                                     
            outbound-interface eth2                                                                                                                                                                                                         
            protocol all                                                                                                                                                                                                                    
            source {                                                                                                                                                                                                                        
                group {                                                                                                                                                                                                                     
                    network-group corporate_network                                                                                                                                                                                         
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
            type masquerade                                                                                                                                                                                                                 
        }                                                                                                                                                                                                                                   
        rule 6002 {                                                                                                                                                                                                                         
            description "MASQ remote_user_vpn_network to WAN"                                                                                                                                                                               
            log disable                                                                                                                                                                                                                     
            outbound-interface eth2                                                                                                                                                                                                         
            protocol all                                                                                                                                                                                                                    
            source {                                                                                                                                                                                                                        
                group {                                                                                                                                                                                                                     
                    network-group remote_user_vpn_network                                                                                                                                                                                   
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
            type masquerade                                                                                                                                                                                                                 
        }                                                                                                                                                                                                                                   
        rule 6003 {                                                                                                                                                                                                                         
            description "MASQ guest_network to WAN"                                                                                                                                                                                         
            log disable                                                                                                                                                                                                                     
            outbound-interface eth2                                                                                                                                                                                                         
            protocol all                                                                                                                                                                                                                    
            source {                                                                                                                                                                                                                        
                group {                                                                                                                                                                                                                     
                    network-group guest_network                                                                                                                                                                                             
                }                                                                                                                                                                                                                           
            }                                                                                                                                                                                                                               
            type masquerade                                                                                                                                                                                                                 
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    ssh {                                                                                                                                                                                                                                   
        port 22                                                                                                                                                                                                                             
        protocol-version v2                                                                                                                                                                                                                 
    }                                                                                                                                                                                                                                       
}                                                                                                                                                                                                                                           
system {                                                                                                                                                                                                                                    
    conntrack {                                                                                                                                                                                                                             
        expect-table-size 2048                                                                                                                                                                                                              
        hash-size 32768                                                                                                                                                                                                                     
        modules {                                                                                                                                                                                                                           
            sip {                                                                                                                                                                                                                           
                disable                                                                                                                                                                                                                     
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        table-size 262144                                                                                                                                                                                                                   
        timeout {                                                                                                                                                                                                                           
            icmp 30                                                                                                                                                                                                                         
            other 600                                                                                                                                                                                                                       
            tcp {                                                                                                                                                                                                                           
                close 10                                                                                                                                                                                                                    
                close-wait 60                                                                                                                                                                                                               
                established 7440                                                                                                                                                                                                            
                fin-wait 120                                                                                                                                                                                                                
                last-ack 30                                                                                                                                                                                                                 
                syn-recv 60                                                                                                                                                                                                                 
                syn-sent 120                                                                                                                                                                                                                
                time-wait 120                                                                                                                                                                                                               
            }                                                                                                                                                                                                                               
            udp {                                                                                                                                                                                                                           
                other 30                                                                                                                                                                                                                    
                stream 180                                                                                                                                                                                                                  
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    domain-name localdomain                                                                                                                                                                                                                 
    host-name ubnt                                                                                                                                                                                                                          
    ip {                                                                                                                                                                                                                                    
        arp {                                                                                                                                                                                                                               
            base-reachable-time 30                                                                                                                                                                                                          
            stale-time 60                                                                                                                                                                                                                   
            table-size 262144                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
        override-hostname-ip 192.168.100.1                                                                                                                                                                                                  
    }                                                                                                                                                                                                                                       
    login {                                                                                                                                                                                                                                 
        user admin {                                                                                                                                                                                                                        
            authentication {                                                                                                                                                                                                                
                encrypted-password ****************                                                                                                                                                                                         
            }                                                                                                                                                                                                                               
            level admin                                                                                                                                                                                                                     
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    name-server 127.0.0.1                                                                                                                                                                                                                   
    ntp {                                                                                                                                                                                                                                   
        server 0.ubnt.pool.ntp.org {                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        server 1.ubnt.pool.ntp.org {                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        server 2.ubnt.pool.ntp.org {                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
        server 3.ubnt.pool.ntp.org {                                                                                                                                                                                                        
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    offload {                                                                                                                                                                                                                               
        ipsec enable                                                                                                                                                                                                                        
        ipv4 {                                                                                                                                                                                                                              
            forwarding enable                                                                                                                                                                                                               
            gre enable                                                                                                                                                                                                                      
            pppoe enable                                                                                                                                                                                                                    
            vlan enable                                                                                                                                                                                                                     
        }                                                                                                                                                                                                                                   
        ipv6 {                                                                                                                                                                                                                              
            forwarding enable                                                                                                                                                                                                               
            vlan enable                                                                                                                                                                                                                     
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    static-host-mapping {                                                                                                                                                                                                                   
        host-name setup.ubnt.com {                                                                                                                                                                                                          
            alias setup                                                                                                                                                                                                                     
            inet 192.168.100.1                                                                                                                                                                                                              
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    syslog {                                                                                                                                                                                                                                
        global {                                                                                                                                                                                                                            
            facility all {                                                                                                                                                                                                                  
                level notice                                                                                                                                                                                                                
            }                                                                                                                                                                                                                               
            facility protocols {                                                                                                                                                                                                            
                level debug                                                                                                                                                                                                                 
            }                                                                                                                                                                                                                               
        }                                                                                                                                                                                                                                   
    }                                                                                                                                                                                                                                       
    time-zone UTC                                                                                                                                                                                                                           
    traffic-analysis {                                                                                                                                                                                                                      
        dpi disable                                                                                                                                                                                                                         
        export disable                                                                                                                                                                                                                      
    }                                                                                                                                                                                                                                       
}                                                                                                                                                                                                                                           
unifi {                                                                                                                                                                                                                                     
    mgmt {                                                                                                                                                                                                                                  
        cfgversion b54e6af22f3f1e81                                                                                                                                                                                                         
    }                                                                                                                                                                                                                                       
}